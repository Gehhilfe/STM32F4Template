CMake-based STM32F4 Template
============================

This repository contains a CMake-based template project as a starting point for STM32 F4 projects. ST's official *Standard Peripheral Library* is already included in this repository and will automatically be linked against the target application.

Both **C and C++** sources are supported. CMake will also try to find OpenOCD and will generate a *flash* target for easy programming of the microcontroller.

This template includes a sample application which turns on the blue LED on the STM32F4Discovery board for demonstration purposes.

# Prerequisites
Get CMake for your platform. You should use at least **CMake 2.8.12**.

For compiling the project, a GNU C/C++ compiler is required. I highly suggest the [GNU ARM Embedded Toolchain](https://developer.arm.com/open-source/gnu-toolchain/gnu-rm).
Make sure that the toolchain executables are in your **PATH** environment. If you want to use OpenOCD, also make sure that it is in the **PATH** and the executable is called `openocd`.

# Quick start
Just execute `build.bat` (rename it to `build.sh` for Linux ;-) ). This will create a new directory `build` and will generate common Unix Makefiles for the STM32 project. If all goes well, you can enter `make` for compiling the project.
This will also generate an Intel HEX file (*.hex*), a binary file (*.bin*), a map file (*.map*) generated by the linker and an assembler listing file intermixed with C code (*.lss*) - besides the obvious *.elf* file.

Use `make flash` for flashing via OpenOCD. In this example, the ST-Link on the STM32F4Discovery board is assumed. You might have to adapt this.

# Options
You may want to use `build-debug` in the early development stage. This will generate Makefiles which compile the firmware with no optimization (**-O0**). Otherwise, optimization for size (**-Os**) will be used.

You can also let CMake generate project files for **Eclipse**. Try executing `build-eclipse` which generates a project directory **as a sibling to the root directory of this project**. This is the way recommended by CMake. In Eclipse, just import the newly created project directory. All paths should have been automatically discovered so that the auto-completion feature works.

# References
These projects helped me a lot while creating this template:
- [STM32-CMake-CodeSourcery](https://github.com/adrienbailly/STM32-CMake-CodeSourcery)
- [STM32F4 Discovery board project template](https://github.com/charleskorn/stm32f4-project-template)
